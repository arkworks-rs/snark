use crate::crh::{
    PoseidonParameters,
    FieldBasedHashParameters, PoseidonHash, batched_crh::PoseidonBatchHash,
    PoseidonQuinticSBox,
};
use algebra::fields::bn_382::Fq as BN382Fq;
use algebra::fields::bn_382::Fr as BN382Fr;

use algebra::biginteger::BigInteger384;
use algebra::field_new;

#[derive(Clone)]
pub struct BN382FqPoseidonParameters;

impl FieldBasedHashParameters for BN382FqPoseidonParameters {
    type Fr = BN382Fq;
    const R:usize = 2;  // The rate of the hash function
}

impl PoseidonParameters for BN382FqPoseidonParameters {

    const T:usize = 3;  // Number of S-Boxes
    const R_F:i32 = 4;  // Number of full rounds (for each of the two full rounds)
    const R_P:i32 = 53; // Number of partial rounds

    // The zero element of the field
    const ZERO:BN382Fq = field_new!(BN382Fq, BigInteger384([0, 0, 0, 0, 0, 0]));
    // The constant 3 to add to the position corresponding to the capacity
    const C2:BN382Fq = field_new!(BN382Fq, BigInteger384([18446744073709551595, 18446743938401437191, 9080387216538132607, 3506492495389803232, 13000497206939044297, 837878176112501072]));

    // State vector after permutation of zero state vector
    const AFTER_ZERO_PERM: &'static [BN382Fq] = &[
        field_new!(BN382Fq,BigInteger384([2348881868142329605, 10976042152235318005, 8787197618900064648, 17102480074424488080, 12432156675573519040, 39240956887935053])),
        field_new!(BN382Fq,BigInteger384([13793925183097955417, 7659858986129211592, 3794405863367061078, 17141669186553206252, 4036468070934466649, 796809540225777874])),
        field_new!(BN382Fq,BigInteger384([16756941179034994497, 5047387293397307590, 3956260546532608329, 6016074043915500962, 7756415306433001885, 127183476525913918]))
    ];

    // Array of round constants
    const ROUND_CST: &'static[BN382Fq]  = &[
        // Constants converted to Montgomery representation. Montgomery constant = 2^768
        // For rounds 4 + 53 + 4 = 61

        field_new!(BN382Fq,BigInteger384([1142645960830323570, 13103856874656979564, 2413523699113461786, 6879845599697826609, 5058580133776391234, 1554316228962593243])),
        field_new!(BN382Fq,BigInteger384([10426584344121882366, 13727490529308850470, 17511205519035160610, 5607264674077626144, 2699631271854258554, 2243648485226869188])),
        field_new!(BN382Fq,BigInteger384([12987560950689738833, 8931187415772511260, 15115164675952728210, 11838283450414904985, 6068887991723343526, 2502537528034826645])),
        field_new!(BN382Fq,BigInteger384([6349468384487265773, 593051281518095970, 11641203927022283537, 3572191156125749552, 5435399464174232152, 1691903655752100649])),
        field_new!(BN382Fq,BigInteger384([1522545241916442357, 14429958678179539454, 4342350448052099403, 11080772263211676169, 417072827418223887, 157122943079572475])),
        field_new!(BN382Fq,BigInteger384([13432552543273452753, 15754699907410827455, 7717697133700719758, 18279174950676320480, 7711014579835187394, 612635677457927620])),
        field_new!(BN382Fq,BigInteger384([6990798739901736226, 979600527998399842, 18155071858026124026, 16123371249893561623, 8107591317020764670, 1049113051890903556])),
        field_new!(BN382Fq,BigInteger384([5346327058857990904, 7900886725189553155, 14956722095646935208, 4163972719130380161, 8028244547871888040, 887179789318538282])),
        field_new!(BN382Fq,BigInteger384([9989582074796907851, 10043636969957313861, 1726249508290311770, 4414589112980387037, 11293834023324958053, 2193564793127899840])),
        field_new!(BN382Fq,BigInteger384([5728709303652205186, 11582483700182666274, 7799001171091944183, 2313852225752072701, 17778585666416861982, 1748061361390484225])),
        field_new!(BN382Fq,BigInteger384([12215706970857372062, 18167183481202418295, 11883268705232553025, 17395261995353003002, 9199000345857479857, 804838617019706061])),
        field_new!(BN382Fq,BigInteger384([14520566991598234216, 9472357852553165271, 11826140007631363562, 15030403332391056465, 13340070734007396864, 2341783548293434575])),
        field_new!(BN382Fq,BigInteger384([8135243440611581511, 6364729417485317365, 18054975765962002604, 2556789596734982455, 9129306280181161423, 1401072596215466153])),
        field_new!(BN382Fq,BigInteger384([4417610205284648991, 13414692620162021258, 13489258344463178606, 13324524367184864296, 14073227476736282078, 1561737626497405083])),
        field_new!(BN382Fq,BigInteger384([10184526728662910457, 5625947902143752746, 16331013583454901316, 4129143109219278356, 17767666628123219686, 2077110198212067131])),
        field_new!(BN382Fq,BigInteger384([18423516384468528645, 6891530135327656955, 3826649459862605562, 2902263710328342770, 1875973413690949232, 1092993648200769598])),
        field_new!(BN382Fq,BigInteger384([4010812777028535265, 1381761454985093260, 15736618873881031000, 11277581076482213321, 12789589489811510411, 1708653600672077491])),
        field_new!(BN382Fq,BigInteger384([7939931306590616754, 7628716560881647240, 11082647883088449078, 6599835517755491572, 11447763755461552662, 141701118054888051])),
        field_new!(BN382Fq,BigInteger384([13073192324849475818, 17323996542501264214, 17937360507807564098, 10742408682035089896, 13866461277340118894, 562513128551209696])),
        field_new!(BN382Fq,BigInteger384([2083058693538523084, 1915462337270722217, 881224023598702030, 5009811360522552474, 2847872252219367689, 433504766158325133])),
        field_new!(BN382Fq,BigInteger384([10921222490325646142, 17367966111261363959, 15310162827443135215, 625228908863899957, 9084529351769069009, 588212878587600889])),
        field_new!(BN382Fq,BigInteger384([14747744328646566920, 14278542307777237299, 7320533909003314961, 14241387903872085230, 15090614307132711632, 1144389970795167153])),
        field_new!(BN382Fq,BigInteger384([4637334036531397778, 8486927522579519560, 8875302261948143197, 8412746935302954963, 12351195129323304946, 447290279808891975])),
        field_new!(BN382Fq,BigInteger384([9052231153944920607, 12621014973885290812, 10830534165529031431, 9993524975929945197, 6198979066744429696, 644346821230247585])),
        field_new!(BN382Fq,BigInteger384([12079129202151310279, 17557499401047313657, 9788191428917294574, 6380390415179567636, 17000168075100249234, 983651293628271403])),
        field_new!(BN382Fq,BigInteger384([17126582575562107119, 11319119484666787032, 3306826719122175313, 18394248889055894331, 11288272887316229893, 1111314719541859454])),
        field_new!(BN382Fq,BigInteger384([14469502157259045314, 17077206547208900808, 5972898661673661919, 3886320745512995684, 4958201378238844976, 666089457281683469])),
        field_new!(BN382Fq,BigInteger384([6846042570056674944, 10503514648145535238, 11702619621724894137, 17606232161474925894, 9363649555986063663, 400684433882760585])),
        field_new!(BN382Fq,BigInteger384([13464499972020258088, 5984745421939989006, 1765674933530540846, 14630026481216778714, 11399403192998911862, 132837610155924345])),
        field_new!(BN382Fq,BigInteger384([464881509203362243, 16247618877795817528, 11425443806199866816, 10840616785890666986, 12357789354967435756, 578232163703471881])),
        field_new!(BN382Fq,BigInteger384([1409696702160702701, 13700423364899377034, 11004471735138840610, 3178005274554994632, 3617388389530062975, 1848658388319013442])),
        field_new!(BN382Fq,BigInteger384([11276387712503721163, 2553433020740393506, 10340760772087204234, 7143691897912637120, 7759980676182472612, 2404850207754242569])),
        field_new!(BN382Fq,BigInteger384([2644292575170738135, 5409406004004843786, 13833882522960096327, 17644744007567526399, 9884839015563000599, 606625516783496014])),
        field_new!(BN382Fq,BigInteger384([3748056117141217609, 17087875805096177657, 12683878993854559941, 1428518499599557582, 3187148780241650513, 152395411996220126])),
        field_new!(BN382Fq,BigInteger384([8646521260330898670, 12850297394046719196, 3078570438187689667, 14680679295099396691, 5817974158478737460, 1189827043080251046])),
        field_new!(BN382Fq,BigInteger384([9072873181139111159, 9169925835578461538, 6095416414418266796, 14115406036048178732, 14256043404275449685, 561173876544091605])),
        field_new!(BN382Fq,BigInteger384([15246144303191628686, 17024268449037432352, 12257641994424345431, 12621921161514773213, 9621481761471715309, 2314369265684376850])),
        field_new!(BN382Fq,BigInteger384([6392307580174861856, 3063026926581252573, 14636612742369427898, 10665515021695722803, 2215234293208715626, 54401903207785907])),
        field_new!(BN382Fq,BigInteger384([13431739419184935982, 15518020676473405230, 6458800954911893863, 3460589893146327763, 13415790631395061722, 1956246112396995127])),
        field_new!(BN382Fq,BigInteger384([1329760467112988799, 11309877597723862037, 925232679615780582, 16626755769985605404, 7806212348836381442, 2172275597728722675])),
        field_new!(BN382Fq,BigInteger384([12273589068800170525, 13278259744554587314, 15905184834280705744, 8805562148933940741, 1269222318696653248, 542839833020412691])),
        field_new!(BN382Fq,BigInteger384([9665195550955705641, 9407952112765130430, 4136911199052919840, 12686076112364917885, 3559252546461926748, 2555726248349085842])),
        field_new!(BN382Fq,BigInteger384([12962130869490852201, 3802913363470743578, 1704110853766045718, 10791954214480017281, 6883965795865792390, 608080372733704603])),
        field_new!(BN382Fq,BigInteger384([13425122470387697314, 9503309875989802568, 5560934769433527265, 12736407989123613849, 9665928910933976792, 2279356250621808443])),
        field_new!(BN382Fq,BigInteger384([12079567078578946967, 12277565385961715117, 16219668965168523719, 5946441759866235120, 8203327594680071263, 1032993378380482693])),
        field_new!(BN382Fq,BigInteger384([12551146381768765139, 2960950394086897727, 9322638658177291064, 12258449394056275829, 18019464085375477397, 1565290323502860590])),
        field_new!(BN382Fq,BigInteger384([1652676345641766895, 3490686220879119394, 154955394943486748, 7896688571614513254, 7531174891523522962, 1963841351048123624])),
        field_new!(BN382Fq,BigInteger384([8261476124275480323, 16873182862540865151, 13049251899310628203, 1759006435184127660, 14550048154751933456, 1385692655263937348])),
        field_new!(BN382Fq,BigInteger384([9557858568408254522, 2396004528332010047, 6080839032784426502, 1501377013988889073, 14694676427832402389, 1069530883725799360])),
        field_new!(BN382Fq,BigInteger384([11318570423760753776, 4104574842490197580, 7252701096595090538, 8285677088720962209, 4668673533466890961, 1381784978969470161])),
        field_new!(BN382Fq,BigInteger384([6785124373955751643, 1825645987261933944, 15116497235512480584, 18317849211789756615, 6927181379657233799, 1314801512053249984])),
        field_new!(BN382Fq,BigInteger384([14904074720885944297, 2725373534314530320, 1824957724678025872, 18186453639117523403, 15756705393424513535, 2229917597635784600])),
        field_new!(BN382Fq,BigInteger384([4795550882456178090, 13163531507473131349, 16090820829452751187, 13612327261511400448, 8935733386134721111, 981346199437127469])),
        field_new!(BN382Fq,BigInteger384([14620240570433076191, 1535115170978285996, 4147074848747322497, 8690501864536152530, 9969919108473463848, 1573216111916347475])),
        field_new!(BN382Fq,BigInteger384([6304296724064390593, 1411873563261546567, 13931528902368331440, 2882378580213576567, 11487932954803965384, 21906498468875372])),
        field_new!(BN382Fq,BigInteger384([5105656271611217558, 8151570266676555967, 7671807621776557775, 11881943998160852762, 507195650105175959, 1382664181715764879])),
        field_new!(BN382Fq,BigInteger384([17806055103730687356, 11855720295381888546, 13064789941492604892, 2582321240365104384, 9855774467660648077, 2117203069631751614])),
        field_new!(BN382Fq,BigInteger384([2649721840838409204, 16827328781486845816, 10408414650714922022, 12867106968761673210, 11717763274395210627, 2174829724160194836])),
        field_new!(BN382Fq,BigInteger384([13298009790041807909, 2315837466545346513, 6719825044714787991, 6413690923210035293, 7157674990120741736, 2100519640079565070])),
        field_new!(BN382Fq,BigInteger384([8848551079465062519, 10460840150911167619, 732545891980339799, 15097951655872448747, 2580930456403501950, 1845202608310401178])),
        field_new!(BN382Fq,BigInteger384([3973427685850562655, 8412353257270297386, 18065754765366795087, 17721996905651138147, 3913041203399648282, 470427725499288317])),
        field_new!(BN382Fq,BigInteger384([4051043710426472977, 17621493163752267547, 1420229459591956461, 896819347192711322, 7939780552310883980, 938217222955295006])),
        field_new!(BN382Fq,BigInteger384([18314111145128195009, 15815331108493126319, 11601202093996281311, 15527825231496460561, 13191032757829598887, 1236919681701261795])),
        field_new!(BN382Fq,BigInteger384([4671267093560434811, 4791181583204807456, 16304321804605091179, 16842059945074572986, 16892082262481635243, 261397025831998772])),
        field_new!(BN382Fq,BigInteger384([7272123346351585385, 6911002507717859067, 1242478370034465030, 16674582037870362552, 7183115717949231628, 895719158961021879])),
        field_new!(BN382Fq,BigInteger384([602090794555005133, 16297172238017281155, 6742339867392042875, 12336819510481593265, 10157475684449056868, 671909665335001899])),
        field_new!(BN382Fq,BigInteger384([4083140417543809894, 6450140377793409873, 12397456015723334786, 16751495912440703537, 1402871144532779165, 1172541355406202862])),
        field_new!(BN382Fq,BigInteger384([13425920880535463571, 4519193604465571454, 822712499437471064, 3799560314982821404, 1735389448206789163, 527236130700855212])),
        field_new!(BN382Fq,BigInteger384([6300826136573476794, 10666454933849799640, 8018131882927613802, 15243798280864498909, 2054089553045544573, 914604607003668559])),
        field_new!(BN382Fq,BigInteger384([4839001978028417055, 15627989959544689134, 4728498214429175969, 13442878472967326001, 11259181190441369090, 1460542299050382774])),
        field_new!(BN382Fq,BigInteger384([12702351098120533225, 7395860347747076562, 14200825921072991573, 8039329553240442592, 8066630879466583455, 511052806989642520])),
        field_new!(BN382Fq,BigInteger384([4187413875260132823, 2504210670678921704, 15423891952098120547, 12829075822104876697, 8434872406813483201, 1630636984601844505])),
        field_new!(BN382Fq,BigInteger384([3777184996879488919, 10991608981369841641, 9633748158998980507, 14198781677810335533, 4778102449281368082, 534593926016392293])),
        field_new!(BN382Fq,BigInteger384([1371083722352805707, 8308330014873871994, 3903951719557814648, 8171220847724978263, 9781694867649639685, 33751177569160971])),
        field_new!(BN382Fq,BigInteger384([12446193545106368927, 5188637338126665991, 15923932823575797216, 1870198710193945700, 15326192660212760035, 1469119681913025789])),
        field_new!(BN382Fq,BigInteger384([5672000822920409976, 1995807557326910903, 3019480598159166886, 8390650980496131305, 8638731740287791267, 499062963689568369])),
        field_new!(BN382Fq,BigInteger384([15176735465798994308, 12083536328438606992, 16954839076304946051, 4671538259020050207, 5627729104217640537, 1595875464601419483])),
        field_new!(BN382Fq,BigInteger384([13618489233426273111, 13188131281196509033, 2165162740382169310, 15802972921847550301, 6395251297656111539, 811821252026950942])),
        field_new!(BN382Fq,BigInteger384([4096612661798505143, 6737176547447007311, 6425349748335369881, 11147114836822039066, 13334223519875481285, 705755655589176711])),
        field_new!(BN382Fq,BigInteger384([4383116721759765101, 9934961289150528037, 12219618733512998185, 10694621577799277872, 8684139767765942245, 2557849775455120339])),
        field_new!(BN382Fq,BigInteger384([2118042821889682127, 1151461164587892860, 15676703247876997439, 3527274357594996568, 14427200291358738511, 1015809050297778032])),
        field_new!(BN382Fq,BigInteger384([1505721390213632110, 9519070656645987582, 7110719012665319970, 7106793254708280799, 15062878937590433111, 1525710542928193056])),
        field_new!(BN382Fq,BigInteger384([8353517882070790804, 15503283386150862051, 8219557309406447126, 5870164062683480030, 605772417668512352, 276197835218387711])),
        field_new!(BN382Fq,BigInteger384([285292260313313886, 9664805085056191988, 1429041512269836023, 17350113855387631499, 2146023802572315654, 1239598494149231981])),
        field_new!(BN382Fq,BigInteger384([7695399552033376146, 10512588399373882176, 14812488757042201556, 9004616139746886406, 16697002293347738142, 1879835083260687561])),
        field_new!(BN382Fq,BigInteger384([16161389054471333606, 13673069910087592935, 15713143065073234137, 16407824501565361693, 15594730756445899449, 452517414317328133])),
        field_new!(BN382Fq,BigInteger384([15057069416366766502, 7636621023167829194, 11248492280263356170, 16480941423931201838, 6240081834557252266, 466889247344747829])),
        field_new!(BN382Fq,BigInteger384([2596045787502548638, 16655452031918481298, 14272389592073382209, 13817797131536574816, 3734379495869436104, 1396134646069160200])),
        field_new!(BN382Fq,BigInteger384([3554829151725256388, 11302276871731610950, 6972373400575209579, 11414734360508952432, 18002988328362804246, 2112905800258501863])),
        field_new!(BN382Fq,BigInteger384([13824958622688032913, 11912161657943198717, 9297430183147965984, 3359673745933319358, 14731167843704032012, 878972269392613070])),
        field_new!(BN382Fq,BigInteger384([1097636481858632242, 7788205298360059855, 15662963102733852224, 1846616324858363163, 4032044118195375265, 631541144176532812])),
        field_new!(BN382Fq,BigInteger384([9851050183784061121, 5497641017970715231, 13582518494873024538, 16078505542606202415, 5917855241262110558, 940525001592936573])),
        field_new!(BN382Fq,BigInteger384([13241082047619022209, 316859943894055131, 16014732433215090384, 8048232114697651112, 12496383378650002754, 288461467745689070])),
        field_new!(BN382Fq,BigInteger384([15498985824205389665, 5321468375908979274, 49607395935944840, 17441854748451218936, 6099753843969246925, 2406730671469762618])),
        field_new!(BN382Fq,BigInteger384([12215695718761971937, 11227194938854341276, 14237397696495395029, 18024538945025807445, 392022533638433965, 1018362889763347207])),
        field_new!(BN382Fq,BigInteger384([10524420143863541357, 11568717741831158556, 1220869590690226939, 3963955808818199858, 2686687343377749698, 2288580841048139931])),
        field_new!(BN382Fq,BigInteger384([11093445216677838473, 8047328668780929321, 13468631135800854801, 14557429229560008606, 6618782434218171531, 1040178350300424657])),
        field_new!(BN382Fq,BigInteger384([10082981896722554013, 13016026280826158995, 4733819656211069058, 3059154988668461877, 14039604238292184261, 1070555196661307136])),
        field_new!(BN382Fq,BigInteger384([5685909599810756642, 14404362130834909487, 3500533085034000042, 8925231298025187744, 1333985551657521008, 2482482184133348973])),
        field_new!(BN382Fq,BigInteger384([390264263115156875, 6701260819917951118, 6737107553506926948, 2556883491192711496, 11903973825487268647, 2518963502936072727])),
        field_new!(BN382Fq,BigInteger384([4538831335255317427, 18278650994293187887, 6729319610667708493, 402280403787483215, 340334482153860637, 1813518439623549306])),
        field_new!(BN382Fq,BigInteger384([1215271633182501766, 13747908231796821340, 11843931306229725088, 6350105569393318035, 10953225288266237527, 258055448051769551])),
        field_new!(BN382Fq,BigInteger384([9329875355370547413, 11588957119919565070, 4677067967528134565, 1082558827949947716, 4134909514213617904, 903388238017286237])),
        field_new!(BN382Fq,BigInteger384([2129503288333226805, 8967872204256923675, 9201627892521726003, 12056724305797623597, 14300017404421415094, 212906611934501834])),
        field_new!(BN382Fq,BigInteger384([4211983354089168925, 5290242294515743032, 10137948826291434527, 8786176241667011627, 5505307423056835418, 686896296249320675])),
        field_new!(BN382Fq,BigInteger384([12165203710876806647, 15362542784418232551, 7007923025795258582, 5966347408799332643, 10167414138558091886, 244997106672892512])),
        field_new!(BN382Fq,BigInteger384([16580653005304872515, 5162857003013042970, 5003562581862018808, 8172311463698964228, 6966931263677977967, 1041567357657086339])),
        field_new!(BN382Fq,BigInteger384([12742087593440944306, 15126839893297546669, 17397638232588994126, 16633109135091944531, 9694792852737355263, 1454013588758242182])),
        field_new!(BN382Fq,BigInteger384([4674935936054684764, 1948218692828760959, 8205562846672481130, 16096190513101446665, 7273383697421115583, 1382926316036819469])),
        field_new!(BN382Fq,BigInteger384([17525975409542510036, 17943903568358440232, 1918541764278317302, 10949300612555960160, 16852265074809702923, 1649229109185512204])),
        field_new!(BN382Fq,BigInteger384([3508876241504995048, 17232613103256723082, 3745383848951888551, 16421071961876523325, 13735705870992895042, 1808257257700319558])),
        field_new!(BN382Fq,BigInteger384([12540371006204227884, 16073552353110086933, 3559245644333433755, 14106460739634803891, 9211756275662533196, 801414649385756626])),
        field_new!(BN382Fq,BigInteger384([6588327667283141510, 2336607169039429463, 3775018333283110002, 2999401680876706493, 13177620713201314393, 1826762515789852237])),
        field_new!(BN382Fq,BigInteger384([14505713310327029863, 4231444653869275554, 14319712026026562290, 15181620296058124605, 17019298755358095448, 616744351411120636])),
        field_new!(BN382Fq,BigInteger384([632826157936687576, 2287536178206511042, 16869451039092222911, 8000849014699812074, 18104102510889769434, 2276168123753366351])),
        field_new!(BN382Fq,BigInteger384([10972128239029864797, 15135633211808217882, 3103462443768028022, 2552426288359059019, 14161164966626705249, 2222258938240672320])),
        field_new!(BN382Fq,BigInteger384([10289381186095657341, 6656373633847363132, 9530055687326216048, 14496377834997535104, 16858143356641248903, 1425072171218560679])),
        field_new!(BN382Fq,BigInteger384([14263400148133798327, 7611071908403415455, 9091853596411177688, 6434999595526590237, 1669864198931831143, 657655568634616324])),
        field_new!(BN382Fq,BigInteger384([555139649456048915, 1217862905597089466, 13991810438163080999, 6851830781257549517, 2617903033214945795, 1108580330892764296])),
        field_new!(BN382Fq,BigInteger384([16925350583173996510, 7470384358852759893, 14971106460390374584, 15564786961688202209, 286982568908160823, 756420285855021911])),
        field_new!(BN382Fq,BigInteger384([2796180166735829438, 8926755474008646041, 9592804570514593170, 10617182772536545442, 7563120025957669757, 2118042526067810399])),
        field_new!(BN382Fq,BigInteger384([1945683550023945133, 15762531525397933360, 6579120616884535184, 8580333911176308712, 16237604500255670018, 670301977717718902])),
        field_new!(BN382Fq,BigInteger384([10796056446401278239, 11444112057693353323, 3855511468051606482, 17884826899106312698, 12082807930763208297, 815345003331473761])),
        field_new!(BN382Fq,BigInteger384([10012853725982898058, 12173412137724629572, 2826716168914433320, 7057556291496424847, 4775007526297362270, 2354206816018181348])),
        field_new!(BN382Fq,BigInteger384([16193956109229051612, 2158517371072331968, 11033326700964322668, 8765296119821334721, 5058225187012886017, 213237804882302260])),
        field_new!(BN382Fq,BigInteger384([1003612045571052805, 14262274599682140980, 9787229649690770230, 16224558997260272654, 1017395607876363798, 201760806129138902])),
        field_new!(BN382Fq,BigInteger384([428518798187586541, 15147270229998917123, 772066040067493088, 3056402072722463255, 10649955475303359268, 2545705597733511659])),
        field_new!(BN382Fq,BigInteger384([4672007199432822635, 2261141097877605148, 12589906771402859713, 15235720856325143959, 399640647081810504, 1240911376644775986])),
        field_new!(BN382Fq,BigInteger384([13268375379116457185, 13942733299288629267, 11211773179673132532, 246645766585758769, 2123563540658752160, 1575413372265639044])),
        field_new!(BN382Fq,BigInteger384([17077163664802696445, 159357900621411926, 2071160783852341191, 14126860381598483874, 15992917103865675794, 365731789552350422])),
        field_new!(BN382Fq,BigInteger384([17881083172881341776, 7096747384665925452, 4512157919247502070, 12284788478471762572, 15564675759978041341, 2039133539038160042])),
        field_new!(BN382Fq,BigInteger384([10090828608341907696, 14522890949939874266, 4013554224960256366, 9915280524197315112, 5446101280301144821, 2429530312759197187])),
        field_new!(BN382Fq,BigInteger384([6996206325517228344, 2033674494196136887, 3424066509325578502, 4638574376114335440, 1081603121600971098, 2467511987933206139])),
        field_new!(BN382Fq,BigInteger384([16897556284689599947, 5947449600139896483, 14882784836238661365, 10593360580682351571, 444383519680992911, 2445179007720435723])),
        field_new!(BN382Fq,BigInteger384([3927272250637413955, 5948033848227959313, 11464077719220063556, 7319444069561211693, 14994182325390142425, 2216878461398010593])),
        field_new!(BN382Fq,BigInteger384([8558453260025350069, 14325871813033794823, 6151625503794769373, 7442256257701607430, 12467315647004443800, 1840837258193252058])),
        field_new!(BN382Fq,BigInteger384([14111361152415707221, 1506079372831506649, 2692623365151334972, 14985897131870145200, 17445603056709427153, 1041315354616679351])),
        field_new!(BN382Fq,BigInteger384([15254303395046878736, 8978728017065182465, 8266011099756941995, 7792760902283631133, 9891991465198964080, 254684240028554784])),
        field_new!(BN382Fq,BigInteger384([12518469929923220962, 18022992510227897658, 7981341218487321480, 2887749426940922577, 6969802954535322381, 1529791363622224980])),
        field_new!(BN382Fq,BigInteger384([5386679943222554635, 11900102029378512127, 7950394565976375662, 2486971081831900696, 15419097466540553898, 1615772228533288831])),
        field_new!(BN382Fq,BigInteger384([11992526899092222693, 10619532299100632999, 8586132830000617140, 10332011301519402403, 15238520814057132430, 1662697566295673746])),
        field_new!(BN382Fq,BigInteger384([15006414532816419822, 281317920526589463, 12984283966508056457, 7759475184284232515, 13862310946123357590, 2455302660355247903])),
        field_new!(BN382Fq,BigInteger384([10280747330802573642, 9329020131717169471, 7264452287807658992, 12930118740074977471, 2762137922090773151, 1580274253698443703])),
        field_new!(BN382Fq,BigInteger384([3296353120792202289, 14345976005637008324, 2388603092375923213, 9640044443171073529, 3448806062861461589, 1674317926392378896])),
        field_new!(BN382Fq,BigInteger384([3472656654607525266, 11019757805500618865, 638444034631692370, 8967049362281489575, 5086083276055038342, 1368685231904158090])),
        field_new!(BN382Fq,BigInteger384([16476239085089589870, 2050754672676530297, 7553275067458571448, 10438697270020478559, 1578085166823077686, 1400731337044356429])),
        field_new!(BN382Fq,BigInteger384([12118815020205834766, 12240651552254473091, 2058366338920861481, 3754638112721661280, 1720967306325066206, 1451913851403134205])),
        field_new!(BN382Fq,BigInteger384([5210826741392455854, 8792160329600614602, 2559285833149803186, 14855110097017789361, 14871924160455101047, 1760681497008556188])),
        field_new!(BN382Fq,BigInteger384([18230644810550553184, 3246347478910737323, 9476857843083428243, 8603501144517910633, 17838769624237150373, 786119221708288642])),
        field_new!(BN382Fq,BigInteger384([7670024197266540255, 4935969587611642090, 11996760133609997939, 7751056069041334360, 18050590119465507959, 1181858563141793688])),
        field_new!(BN382Fq,BigInteger384([4682997838941618417, 7240450677616410248, 17270017992198832837, 11798330654669786847, 2113226259817733394, 877309184464820220])),
        field_new!(BN382Fq,BigInteger384([418057114837099663, 931540514835039021, 17310667370263071520, 16764465604686832118, 7741647759190089687, 58999831593939290])),
        field_new!(BN382Fq,BigInteger384([16687145899963575685, 15748961767707267620, 3024095208299502532, 16539648863317604101, 10442174349574550357, 1173827596258165846])),
        field_new!(BN382Fq,BigInteger384([9450519053219917059, 6716215807596889523, 17275587883701963107, 2606252797941953068, 6529346863625470427, 1070472681554482002])),
        field_new!(BN382Fq,BigInteger384([17359427376153965744, 8134357391122875836, 7781402427731405657, 4076390413030860937, 17041345080783628620, 802831756535644740])),
        field_new!(BN382Fq,BigInteger384([1193696781564207326, 2300048631755525000, 13832481341600269243, 17587332797854805899, 8750113987782101106, 446052887845956183])),
        field_new!(BN382Fq,BigInteger384([5926353814202157187, 9645653872188571688, 17871804502806426170, 6949252605531975400, 3816778581600741056, 208711086299357995])),
        field_new!(BN382Fq,BigInteger384([6135640154471815553, 6625994932960649022, 16991192173012752201, 11773904496841395798, 12678807920880154486, 1132192945064837405])),
        field_new!(BN382Fq,BigInteger384([8999146691793318948, 11938785623168639603, 3019062900038547955, 11578879000360855451, 13346557300156788727, 572418658603702815])),
        field_new!(BN382Fq,BigInteger384([13122043423149974484, 15048536584964999618, 14876392248078904922, 14886441650995609365, 15770403663426035117, 1623621588731823566])),
        field_new!(BN382Fq,BigInteger384([8874622231494793113, 5189497262233410028, 11073664296681982215, 10678946769242679092, 14854153121584240827, 556891424593971661])),
        field_new!(BN382Fq,BigInteger384([10966910114923597551, 16105408802160646762, 13343817808365636631, 4373808159931815745, 760799961948142708, 2259205473792809621])),
        field_new!(BN382Fq,BigInteger384([13215775769273731534, 6279527091464729915, 7634826041452114382, 8356175020383461307, 2218572901558198377, 190106189983181257])),
        field_new!(BN382Fq,BigInteger384([1975721836613405535, 18309101402229732141, 4179565598769366956, 1195362976779305517, 4371208919801861995, 1034922437898685070])),
        field_new!(BN382Fq,BigInteger384([17761555830221301262, 18109886912360970957, 12027552292611033427, 12887374585794420264, 7950935383865157769, 740873137811516321])),
        field_new!(BN382Fq,BigInteger384([3082038514285873156, 620412520756307453, 550237119184694962, 889276210488011320, 9486089291925974053, 2144041069017699030])),
        field_new!(BN382Fq,BigInteger384([9160612768710431195, 6896489605524756958, 13457627707622724968, 13160300306831106877, 18391630006770630, 423779101424887282])),
        field_new!(BN382Fq,BigInteger384([6804262408175629525, 3582717726232494246, 15650940692505441564, 1964998622414310401, 2761635945677204927, 2334085907282803188])),
        field_new!(BN382Fq,BigInteger384([1544306270566777468, 4436243139742003981, 1319185742078949983, 11398746387772963275, 16967265158265204419, 170440818945339281])),
        field_new!(BN382Fq,BigInteger384([13242300104414862634, 7343343898780388958, 4767239204836554642, 2742610212230282337, 11673114235761501089, 1068821821607308962])),
        field_new!(BN382Fq,BigInteger384([14571313072217218198, 7278186536459653458, 7798790786467704281, 7651220745829849174, 9030004714472618017, 285693616995486669])),
        field_new!(BN382Fq,BigInteger384([9632662648044576630, 11361746083292755722, 7910608007895236953, 3393435950453759158, 9414881465327128459, 1059279761552206844])),
        field_new!(BN382Fq,BigInteger384([11390535935540053654, 3187210504153568794, 7486773071063374678, 17635079503880998035, 15655184817481366940, 2529672633608742457])),
        field_new!(BN382Fq,BigInteger384([5108991483123746666, 7189439793103833664, 17904140106259669993, 3486312687103659481, 9656104793582155849, 2322989173126466372])),
        field_new!(BN382Fq,BigInteger384([7657402173516502523, 16691485493052483346, 4148004815133331129, 15039241039672005355, 2682258593655895073, 812321351357439209])),
        field_new!(BN382Fq,BigInteger384([613989600722640232, 9043767755081361928, 18170205805626703130, 16158587538383362141, 6356342121838876042, 1653108089870320466])),
        field_new!(BN382Fq,BigInteger384([17711480989723597029, 9188348827895563322, 11944344300634682532, 10394484957431474889, 13915716815997209052, 939585127945040588])),
        field_new!(BN382Fq,BigInteger384([2280874431171252938, 8724502064457373299, 10372332303517242388, 1256310656356820839, 9197280440206394112, 1594539838559325937])),
        field_new!(BN382Fq,BigInteger384([14421305635940437803, 13192865622281684358, 9589447965383337162, 17566555237421088246, 15477804282145996579, 151554067356792301])),
        field_new!(BN382Fq,BigInteger384([16826871307692785432, 4879054515487983042, 16355577515984487594, 2010962165550993575, 13603045197140861578, 1434636283054750237])),
        field_new!(BN382Fq,BigInteger384([9643363698293689564, 2427929205922754437, 14554259437682412605, 18030194456774938235, 3588634968982338839, 285931666556231326])),
        field_new!(BN382Fq,BigInteger384([4886428994723446962, 17948450460960035161, 126096003950731545, 3718391538761370120, 1828549660889397799, 395804716138922169])),
        field_new!(BN382Fq,BigInteger384([14636426116500633020, 2785921381164605322, 15183786430305994417, 5913221033460517134, 2261762898022359629, 1261096112016867571]))

    ];

    // The MDS matrix constants
    const MDS_CST: &'static [BN382Fq] = &[
        // Constants in Montgomery representation with R = 2^384
        field_new!(BN382Fq,BigInteger384([18446744073709551614, 18446744060823064527, 18433126471774633215, 10874948279775915516, 2116558975599411438, 2441058215519309248])),
        field_new!(BN382Fq,BigInteger384([18446744073709551610, 18446744035050090351, 18405891267904796415, 14178100765618194934, 6349676926798234315, 170922902394322305])),
        field_new!(BN382Fq,BigInteger384([18446744073709551612, 18446744047936577439, 18419508869839714815, 3303152485842279417, 4233117951198822877, 2285782625084074931])),
        field_new!(BN382Fq,BigInteger384([18446744073709551610, 18446744035050090351, 18405891267904796415, 14178100765618194934, 6349676926798234315, 170922902394322305])),
        field_new!(BN382Fq,BigInteger384([18446744073709551614, 18446744060823064527, 18433126471774633215, 10874948279775915516, 2116558975599411438, 2441058215519309248])),
        field_new!(BN382Fq,BigInteger384([18446744073709551610, 18446744035050090351, 18405891267904796415, 14178100765618194934, 6349676926798234315, 2440510705233791302])),
        field_new!(BN382Fq,BigInteger384([18446744073709551612, 18446744047936577439, 18419508869839714815, 3303152485842279417, 4233117951198822877, 2285782625084074931])),
        field_new!(BN382Fq,BigInteger384([18446744073709551610, 18446744035050090351, 18405891267904796415, 14178100765618194934, 6349676926798234315, 2440510705233791302])),
        field_new!(BN382Fq,BigInteger384([18446744073709551614, 18446744060823064527, 18433126471774633215, 10874948279775915516, 2116558975599411438, 2441058215519309248])),
    ];
}

pub type BN382FqQuinticSbox = PoseidonQuinticSBox<BN382Fq, BN382FqPoseidonParameters>;
pub type BN382FqPoseidonHash = PoseidonHash<BN382Fq, BN382FqPoseidonParameters, BN382FqQuinticSbox>;
pub type BN382FqBatchPoseidonHash = PoseidonBatchHash<BN382Fq, BN382FqPoseidonParameters, BN382FqQuinticSbox>;

#[derive(Clone)]
pub struct BN382FrPoseidonParameters;

impl FieldBasedHashParameters for BN382FrPoseidonParameters {
    type Fr = BN382Fr;
    // Number of partial rounds
    const R: usize = 2;  // The rate of the hash function
}

impl PoseidonParameters for BN382FrPoseidonParameters {

    const T: usize = 3;
    // Number of S-Boxes
    const R_F: i32 = 4;
    // Number of full rounds (for each of the two full rounds)
    const R_P: i32 = 53;

    // The zero element of the field
    const ZERO: BN382Fr = field_new!(BN382Fr, BigInteger384([0, 0, 0, 0, 0, 0]));
    // The constant 3 to add to the position corresponding to the capacity
    const C2: BN382Fr = field_new!(BN382Fr, BigInteger384([18446744073709551595, 18446743938401437191, 9080387216538132607, 3506492495389803232, 13000497206939044297, 837878176112501072]));

    // State vector after permutation of zero state vector
    const AFTER_ZERO_PERM: &'static [BN382Fr] = &[
        field_new!(BN382Fr,BigInteger384([13755790656820249521, 14696425433996656186, 224729399875234210, 17819063072274494576, 15757287417390336236, 1396551602079542651])),
        field_new!(BN382Fr,BigInteger384([10241232145326547156, 7907112045634101037, 18057351909550448638, 15584887309738908503, 6977304083593217510, 507034531229219740])),
        field_new!(BN382Fr,BigInteger384([18094702129213437384, 9932889296162944432, 3649967953822044992, 7409727404422030832, 7927124830961475410, 1291173751774228904]))
    ];

    // Array of round constants
    const ROUND_CST: &'static [BN382Fr] = &[
        // Constants converted to Montgomery representation. Montgomery constant = 2^768
        // For rounds 4 + 53 + 4 = 61

        field_new!(BN382Fr,BigInteger384([8194766694145669507, 7188863510214511890, 13912473340830233741, 8410018237892050446, 755366085174236854, 2391227650143111718])),
        field_new!(BN382Fr,BigInteger384([3109695786627867184, 5279181711364818991, 9372283328465803623, 10277208679207434936, 650164450323295476, 615227039652357142])),
        field_new!(BN382Fr,BigInteger384([16584472110459462176, 6038011070074603454, 11672953257424595736, 8123767316002472954, 2888968555747992567, 2409776521164350983])),
        field_new!(BN382Fr,BigInteger384([6151060258182565130, 3665961424006360721, 13448351072052725698, 8614278721973426187, 10853398171008674509, 756373055497818081])),
        field_new!(BN382Fr,BigInteger384([3401623074476168730, 13381520525348181723, 12129494585620664034, 15648371701351738121, 15270150449258413619, 640029033043817618])),
        field_new!(BN382Fr,BigInteger384([6977248897730766496, 6691829967720256955, 17122583555113872969, 3114447882335759004, 11092514211507743208, 2128295766219489402])),
        field_new!(BN382Fr,BigInteger384([16348772487716686105, 11484862100363024807, 8481066534389284399, 17692435145301806051, 17297677134619261410, 920013838306298943])),
        field_new!(BN382Fr,BigInteger384([12904544187803251998, 2343804945389207535, 15681971373871423305, 6882326353121896471, 11843163212693203037, 881371692521307916])),
        field_new!(BN382Fr,BigInteger384([8060117192724366861, 16459554089808754382, 4360866610577603708, 11782159641378455191, 13141157569093423276, 2080804869550888074])),
        field_new!(BN382Fr,BigInteger384([5531639402260825816, 14994228783423069539, 8766862051714770891, 13855741253801564988, 12910134272610862407, 1194938697465428140])),
        field_new!(BN382Fr,BigInteger384([15247326238668725632, 6459610600326393346, 791449536497079025, 6150956692317707579, 4173461391729876108, 1141893108406788038])),
        field_new!(BN382Fr,BigInteger384([3052586723647837365, 3478578770389164918, 2434841253729204776, 7601699321664949998, 1548845631299671845, 2275160960752147561])),
        field_new!(BN382Fr,BigInteger384([12939864792533098560, 12933896066783028330, 14517268130408938946, 10863217714727700839, 4538414292603536866, 57004183227263481])),
        field_new!(BN382Fr,BigInteger384([15285137186723846049, 5477945294722916577, 258764767945856340, 15119501538428108669, 253340817321802823, 636707495038848551])),
        field_new!(BN382Fr,BigInteger384([11530150077486145084, 4722061357187819306, 16591184683411835174, 431283686643550916, 4249854342550397776, 2075756210635174122])),
        field_new!(BN382Fr,BigInteger384([8744443423398934480, 9274833443378566252, 9154307729842149688, 5429641782387378925, 9571216666825228816, 1637716168796000041])),
        field_new!(BN382Fr,BigInteger384([3064093960929821389, 6787375926515642824, 3775968642045277594, 6142654983190422152, 18386499123260756835, 2251358787772478990])),
        field_new!(BN382Fr,BigInteger384([4371973024109904380, 2580329881775611620, 476000973845727747, 12858564765607265093, 14110321038220172757, 756187378184645501])),
        field_new!(BN382Fr,BigInteger384([13238471329290723173, 13606669009501928573, 9859771843263368585, 11119298546927271084, 4086340470512495476, 1684919777817846246])),
        field_new!(BN382Fr,BigInteger384([1812535884156962522, 10584594181558995123, 9432528547474295822, 3115165487195998482, 12472148952439330268, 1020884792334309154])),
        field_new!(BN382Fr,BigInteger384([15844051073952402664, 2288682431000785472, 14534636020195015721, 11244858767312813070, 12307442585627207852, 414376958226782254])),
        field_new!(BN382Fr,BigInteger384([10293529394154883519, 14347156142556804409, 5723582862304005062, 10701524143196367900, 17669373996287332207, 5930584975564702])),
        field_new!(BN382Fr,BigInteger384([10790144061094648628, 11231351024233677287, 2000818959046771933, 2290681311673878502, 13572365668386118225, 2493060809165343849])),
        field_new!(BN382Fr,BigInteger384([6958190103455737450, 12873680590931779570, 124008986992990558, 6419671943505951851, 16507640675192976277, 2131978813868048918])),
        field_new!(BN382Fr,BigInteger384([7497723331623623162, 12020531069186821403, 1772464720019094992, 5100949248454665706, 16367467892319744323, 977483502676317847])),
        field_new!(BN382Fr,BigInteger384([15484308086606290352, 9890887348694651492, 727279018843712441, 2698736183999995317, 1686608879972599006, 2265419484845625838])),
        field_new!(BN382Fr,BigInteger384([9113640390520557086, 13862232032934185168, 14867950100620845874, 11568232288258358927, 5064259404916375129, 772087023219842042])),
        field_new!(BN382Fr,BigInteger384([13862836947431639242, 5065538017785106310, 6379374961140114461, 12129273771559123469, 14436875394895266337, 427297989256565182])),
        field_new!(BN382Fr,BigInteger384([15932320763140509191, 13810160843099788451, 10246581852334496042, 454096177618804911, 4669680664832763152, 230868509821640247])),
        field_new!(BN382Fr,BigInteger384([5560947400023073279, 6543930745164398847, 9006947384879018412, 9345767890855875238, 13799126534843101304, 7086206456549128])),
        field_new!(BN382Fr,BigInteger384([14745149277923136241, 4952784450082855316, 7259941796973808725, 1316219643237196089, 5430652454993362709, 1411549964381597384])),
        field_new!(BN382Fr,BigInteger384([11080505777411947683, 12374984155653894429, 8367413549326563036, 17449032996736019980, 17062111318282742806, 1985226656845757785])),
        field_new!(BN382Fr,BigInteger384([17032192791177521102, 1569811302306364325, 3904282336758789803, 13429814198682686065, 18043021663058074152, 1017289889034549605])),
        field_new!(BN382Fr,BigInteger384([8877690753444501286, 8357379211365034104, 8151149151460867187, 5548167720790332433, 8506702027250074341, 2307218576755382906])),
        field_new!(BN382Fr,BigInteger384([13071643077752686942, 4006672484504519727, 8373218883503891894, 6721745410977097507, 13438351975736997789, 2218981978298200452])),
        field_new!(BN382Fr,BigInteger384([629248752316379973, 12977126122809937381, 16163580950535137201, 9734606677758526334, 10816122271427775462, 1909809882805123648])),
        field_new!(BN382Fr,BigInteger384([10796544524126347189, 3551540174018380264, 168480497995551482, 13039058898986930920, 4927904219657861190, 515944438328624416])),
        field_new!(BN382Fr,BigInteger384([2496935329985073958, 17815572493325226901, 1338195791639637934, 297145724528206114, 13345935213513550840, 2255758383208355989])),
        field_new!(BN382Fr,BigInteger384([6767192789123959077, 6362933893141305725, 6680231465524931390, 9246888975316126209, 2068574405263081356, 576746267851956301])),
        field_new!(BN382Fr,BigInteger384([8675499034402641365, 8586183001398680610, 13551736976463540837, 2634973015169958563, 11468468236553361121, 450905920910053608])),
        field_new!(BN382Fr,BigInteger384([17141763252296458075, 6685415252200192533, 1305123883786497253, 1891096580082651934, 10519360550069529768, 1839441099187264904])),
        field_new!(BN382Fr,BigInteger384([7228830955041012589, 1980249904548686674, 10135557764900912985, 383335718943920252, 16874986091916134027, 1693931194221414450])),
        field_new!(BN382Fr,BigInteger384([15145471944891073659, 4096883839275268175, 2737862663152907702, 15306471991477267599, 10373686497071981052, 862849649219164213])),
        field_new!(BN382Fr,BigInteger384([22925840624406153, 714523821388315932, 13884875119028123048, 11139249529784452188, 12766882720827125723, 1963771914409546594])),
        field_new!(BN382Fr,BigInteger384([14176998237760914604, 11430516193733407728, 9227941591430661387, 13023153564200246631, 8315229483853208396, 1727258892794985389])),
        field_new!(BN382Fr,BigInteger384([10374541860260694920, 2594277200047093159, 9757281655270521827, 4175980752092092870, 103094762082378495, 460475443241171810])),
        field_new!(BN382Fr,BigInteger384([7495906236566140032, 15121660508133997223, 13389250951719895381, 7421689465571810452, 5702646045752178998, 8113991342581885])),
        field_new!(BN382Fr,BigInteger384([8242711891314084049, 14761214826029763110, 13016778198917941049, 898148099488070711, 13000741237518766949, 1330305600779056661])),
        field_new!(BN382Fr,BigInteger384([2769778260472839699, 9730869790715580687, 13808775851961751142, 15124765994735392725, 6694814439671057752, 767215024107441800])),
        field_new!(BN382Fr,BigInteger384([14370466999997570660, 7834614005019242210, 16317232461158241381, 996578992443832379, 2727262769843482249, 936122209153163726])),
        field_new!(BN382Fr,BigInteger384([2643500020066427262, 2604371958195870786, 7170110735270749221, 8392657200652643066, 10177034126199082555, 1146136580564959221])),
        field_new!(BN382Fr,BigInteger384([2782570043678588951, 12244389857507379541, 14823744947499139372, 12011858476715831590, 14044159812543760079, 2044015094946198529])),
        field_new!(BN382Fr,BigInteger384([2148998827188898320, 8315504726969555710, 6408120937940425210, 8607040138114016763, 2703529911044550479, 2179466068390058867])),
        field_new!(BN382Fr,BigInteger384([14542322212272236686, 6193082437426483886, 6043810641495730159, 1161632410226936154, 3267777710026843363, 403031926113296268])),
        field_new!(BN382Fr,BigInteger384([10897658092753246262, 7607470137226402172, 1958196663759354281, 9247112512649330527, 1321121723266219262, 420585989180775454])),
        field_new!(BN382Fr,BigInteger384([11788357647804683280, 5979466420674746504, 2376495610783413543, 7936711431255217206, 3373807800200305516, 133193253516044653])),
        field_new!(BN382Fr,BigInteger384([2894422643393979113, 6346134712304378596, 17421034738443393073, 16647244870845904720, 11398315414001805192, 361544732640177608])),
        field_new!(BN382Fr,BigInteger384([12683636243165676706, 11056473099776605536, 7977075628377586828, 11826236410652155187, 12536129415901009148, 325014985181779000])),
        field_new!(BN382Fr,BigInteger384([13855349655181822610, 6381492609987239102, 10843800356464536764, 709738407879750708, 9723889883329559862, 2526487963168109686])),
        field_new!(BN382Fr,BigInteger384([16908136327549269845, 527572033159772567, 16389390372572461468, 119203974584326259, 11598750908784959397, 505617248058706510])),
        field_new!(BN382Fr,BigInteger384([5356698562087459123, 14675090169550583708, 6514498411395588864, 14964526191414297578, 15012829005259982265, 1650722911544823456])),
        field_new!(BN382Fr,BigInteger384([8040329045256859531, 6529177495559113279, 7094902616634262631, 12116228627733215138, 14214848452404942869, 869790879552600719])),
        field_new!(BN382Fr,BigInteger384([2386648183496320049, 3646329240220468085, 11497849826187236396, 14237728272380893419, 17780717189582594573, 862388129550311717])),
        field_new!(BN382Fr,BigInteger384([16904310559326446536, 13895021668261799804, 13282520420871742157, 6785863553779373692, 12884451450300459356, 1001320140613320726])),
        field_new!(BN382Fr,BigInteger384([16115031970522151886, 9593558419740488960, 5541134844665909156, 331053128321874353, 11110880667781118617, 1830013706294768148])),
        field_new!(BN382Fr,BigInteger384([2005403260574336355, 15784412141940434331, 7522327301463173976, 4525786480769339602, 12815204673583253855, 720314461978299372])),
        field_new!(BN382Fr,BigInteger384([14847872472496091040, 3264620646426528336, 9025836651421929839, 1211133018194308277, 1801323017295347857, 458992323808227575])),
        field_new!(BN382Fr,BigInteger384([8190405784447870408, 15381357954233308426, 6818013511814059784, 13851488759528698976, 3649536197303473461, 1510157399672532702])),
        field_new!(BN382Fr,BigInteger384([8403677729093384833, 13259696106925781127, 9255950143090278858, 7592946543997984976, 15660474553521401, 948595859339717442])),
        field_new!(BN382Fr,BigInteger384([14933330360190785049, 5778652930444973719, 7315243399656173689, 7570409004448960700, 438831419743690081, 2172056385861338661])),
        field_new!(BN382Fr,BigInteger384([11115650501407756549, 11635529467221721724, 3119604525528280975, 15712164311080756995, 16191538286427192862, 616023965413010155])),
        field_new!(BN382Fr,BigInteger384([16819591902134990757, 7697170005623477962, 8187698058722579677, 2721403183754901230, 13993135303346484907, 2090457886500198185])),
        field_new!(BN382Fr,BigInteger384([17638952572089942075, 8747532525454762293, 8594554769137766192, 4677949815112668532, 17965897815874828296, 2135734317509539365])),
        field_new!(BN382Fr,BigInteger384([12469409069667225136, 74738282841728825, 10586940802154393271, 12067856048798345272, 7561023297190678416, 826603520866870793])),
        field_new!(BN382Fr,BigInteger384([3455479718833491008, 4065206323154997934, 10570505485350585357, 9236127666990373313, 17776347625728527662, 942575220427002603])),
        field_new!(BN382Fr,BigInteger384([6223443856028185755, 9320596161178301505, 4330647431992877622, 12998043540335144894, 7950363077524708914, 1824815772334211072])),
        field_new!(BN382Fr,BigInteger384([3185463978005241759, 2535168186583002058, 2798274028141069081, 10619808951729366359, 10224426984922607356, 1367765566751022412])),
        field_new!(BN382Fr,BigInteger384([10572746063649850753, 15515732037851501990, 11668677000928589550, 16423187833854480985, 4265535109481931494, 202768509577680508])),
        field_new!(BN382Fr,BigInteger384([17013456209831178525, 17267147966855877536, 7506727329288930137, 8651331247430554708, 17928770508772450947, 451202338772296598])),
        field_new!(BN382Fr,BigInteger384([11997209743344087284, 11943070801632850570, 1380040979269317635, 2884657658485362986, 6518021671010141758, 1704662140556962290])),
        field_new!(BN382Fr,BigInteger384([11709769687444891706, 6659113486012600501, 8613914818487542306, 9623095578003125588, 1342521878249898878, 1230923446027980798])),
        field_new!(BN382Fr,BigInteger384([11101365608514845152, 10797926620782423845, 16691521240512694940, 11403648734082263088, 10495502196214671721, 287938034794478615])),
        field_new!(BN382Fr,BigInteger384([3363064081842315802, 23649094934480455, 17458708671614814376, 17786906316048715705, 3626876381373993123, 2338475879426218165])),
        field_new!(BN382Fr,BigInteger384([7648683666121509260, 1153798705279199187, 12006425264777792135, 12430464528175971125, 17933454191630036995, 70479819300209266])),
        field_new!(BN382Fr,BigInteger384([13731721108517636140, 6326957004685920611, 4773663579756044597, 18224513546136476380, 13670989657414851055, 1866556636625068868])),
        field_new!(BN382Fr,BigInteger384([9780669726570082870, 5081272798492607792, 4749348396349238336, 16603210393266508821, 17917731602314698961, 630265241160778274])),
        field_new!(BN382Fr,BigInteger384([13839099961558246928, 10170496138427154215, 14834279625438456630, 14090570725043490852, 12898899486643540660, 612913515787756397])),
        field_new!(BN382Fr,BigInteger384([14320451568831618519, 14232821298862942859, 17706876056990531667, 3144768187570911414, 8329422699145162957, 2282023146386518135])),
        field_new!(BN382Fr,BigInteger384([2092926160071808427, 2868236717878375002, 12093550483246825479, 3095517633779270763, 7414380759652282355, 2275325315554273886])),
        field_new!(BN382Fr,BigInteger384([808746750810411352, 5213789025695424356, 2855728784331060442, 11389320117972652500, 1183975056892558100, 1477421317226980283])),
        field_new!(BN382Fr,BigInteger384([11620488142347881222, 17036078774755566176, 13705188042736847529, 8116490893716725243, 5112806595174163620, 55337628679069042])),
        field_new!(BN382Fr,BigInteger384([14497477642271198343, 1118022774985258246, 7813797826761560413, 10367280922353445404, 15161634038535228058, 252476012336961665])),
        field_new!(BN382Fr,BigInteger384([8559104707578408097, 8044401449415350346, 10496099411604032115, 13213546420754262164, 16911612038679540585, 2461110635477541187])),
        field_new!(BN382Fr,BigInteger384([7812204685688852069, 14716882132404921957, 8246499151628482586, 11594859960855844054, 2720626650464250204, 759823298171646533])),
        field_new!(BN382Fr,BigInteger384([15449607954808327325, 909971685388763745, 10515687485586464019, 17681436463256371468, 14335759138363129058, 2041967221272397845])),
        field_new!(BN382Fr,BigInteger384([18099608564040566517, 5482923800796272426, 13650504389110141528, 16430215392917562825, 979216379509389485, 1230778663177160773])),
        field_new!(BN382Fr,BigInteger384([16211402900345720250, 7316947449793427346, 4468066040007384227, 5063228407916294563, 3446100492766432234, 2362762524095006553])),
        field_new!(BN382Fr,BigInteger384([12562399295585096483, 13790592045005339131, 14931242401592977974, 5846727512534990157, 15498365847294703026, 2130264963416163625])),
        field_new!(BN382Fr,BigInteger384([11555747407457790254, 8586773609759403032, 16293933490634277051, 2898088156423232586, 10869604830216246405, 363524420018854855])),
        field_new!(BN382Fr,BigInteger384([1489884409960910017, 15949049414616476104, 797978913782340285, 15250214119034751796, 10850360688517754877, 2330613379122634578])),
        field_new!(BN382Fr,BigInteger384([3554706486495037549, 10146570497293969333, 15281648884854281491, 3004606036057274538, 16603492767243966382, 1544685511193165848])),
        field_new!(BN382Fr,BigInteger384([14574592553578166178, 10163294915529572738, 7554032971310027932, 3817143891742935017, 12581239255282754197, 2090241014272111180])),
        field_new!(BN382Fr,BigInteger384([3014406515558377403, 15644076333490487639, 5430389242194761748, 2849976481102008054, 17632365540908315548, 2246970487811137883])),
        field_new!(BN382Fr,BigInteger384([15288234172410923700, 9724522278003886375, 4288000127907380948, 7085910396415641785, 2778255510243582641, 2373066701505857872])),
        field_new!(BN382Fr,BigInteger384([3068025632683888445, 3503495503095770191, 13068862825293977133, 3045803001712052602, 9444227934206894531, 2498817757064920869])),
        field_new!(BN382Fr,BigInteger384([79237541106344713, 17160586402885676804, 12650674402532879831, 17393148474622669933, 16584389711538871337, 7015364337594250])),
        field_new!(BN382Fr,BigInteger384([13150792459156237123, 12404365704995341114, 12468194990872285170, 4132025416630708537, 3859812348180599988, 279302832317990966])),
        field_new!(BN382Fr,BigInteger384([11830142641056987930, 15938758186302729996, 13859259099108628625, 3695578650181184675, 12058548927732388555, 1432094255386512057])),
        field_new!(BN382Fr,BigInteger384([16206759736086137748, 6612252202764684724, 6504501023622997434, 2564806885632950755, 15998858019990779908, 1692758359132463700])),
        field_new!(BN382Fr,BigInteger384([660079676556372880, 3146793218859953005, 11693952676343281680, 7937096699474079738, 4181984393288112919, 875865205990670061])),
        field_new!(BN382Fr,BigInteger384([12949057839626227992, 2120756755167359602, 5527258596805867971, 2477137127895676220, 16439193916442641054, 1700057865119757612])),
        field_new!(BN382Fr,BigInteger384([6972590105978194013, 12268162703077868491, 873931249060907431, 18022505464005407282, 12646375969027106785, 1750457244937885470])),
        field_new!(BN382Fr,BigInteger384([3670222816756345299, 2556388180935988219, 7919462366739110655, 11300698170594152370, 1879137766316083352, 945044203040096979])),
        field_new!(BN382Fr,BigInteger384([17204665738359602608, 16179987038252059293, 14505897970728603872, 12481247032748783541, 9126881882581486305, 1266009121365986515])),
        field_new!(BN382Fr,BigInteger384([4609436214095819934, 11407203299067349670, 9259999793448977977, 4582744616902549648, 1534698178454323287, 1067821041824632929])),
        field_new!(BN382Fr,BigInteger384([2167870060667645332, 6354335159553876916, 3311598981231942097, 9729368305257673914, 6259620777221697912, 2123864779198280855])),
        field_new!(BN382Fr,BigInteger384([10070893907111363198, 17392441942672165202, 9917083577185567664, 12018530717538646321, 14377378671628851991, 1079201980056136921])),
        field_new!(BN382Fr,BigInteger384([4972244580512408287, 2508851802786771795, 5478147196383658154, 14517016424096624298, 569033504196949693, 2006070093356323384])),
        field_new!(BN382Fr,BigInteger384([11207061982805012055, 28979184802266580, 16014286882925680321, 15990255429968120292, 14929202853167272710, 872079138503361513])),
        field_new!(BN382Fr,BigInteger384([7592760969062165509, 9746381302460030036, 2905020206688342118, 6660216687136092927, 4403515774575285685, 2399937818589308540])),
        field_new!(BN382Fr,BigInteger384([5640957625895651874, 3049991055653467777, 10699905893124361091, 5445410550664806852, 569310535340872335, 1837726720637292972])),
        field_new!(BN382Fr,BigInteger384([9482837588697881127, 6686701719142760555, 4531464286977720000, 998952561822933786, 3027574988566033792, 1087394121068285696])),
        field_new!(BN382Fr,BigInteger384([7225119650419420112, 14681112610947242591, 14108723724550417634, 4647350646633747930, 5837704185902313566, 2059989431755322576])),
        field_new!(BN382Fr,BigInteger384([17209360326141727108, 13225100835856257999, 13614963629223372995, 4849873164454357821, 10725355159391684458, 2162591889610329021])),
        field_new!(BN382Fr,BigInteger384([12095418257028350647, 6858776817728369179, 17510076490746097252, 11244052854833633005, 9017283530209664636, 938527852141111301])),
        field_new!(BN382Fr,BigInteger384([14694902406952434196, 6455250804488912751, 5346548921416834457, 7782916975960236226, 12659702285159533755, 260132192194382817])),
        field_new!(BN382Fr,BigInteger384([14537803606388569642, 706292437049206993, 10038767941617065064, 3364380209546239920, 16240337219898221711, 1151956414197863070])),
        field_new!(BN382Fr,BigInteger384([16588249834159585011, 14946572855273367862, 13398626569087144720, 9161420209329717897, 11964763757661919999, 601737025775127051])),
        field_new!(BN382Fr,BigInteger384([1198095924266554855, 1034622790203241096, 11625804899899899990, 16694316383307572406, 3138690219567233521, 2572844862116389781])),
        field_new!(BN382Fr,BigInteger384([7292785072505949633, 11003978980379519009, 6645711269028359183, 15608599987051659518, 2591101703331496356, 2037963101223428180])),
        field_new!(BN382Fr,BigInteger384([8297612320327984208, 8964438522145437244, 11995980328856292544, 12662074112889836978, 7135320549804215694, 91006767841404510])),
        field_new!(BN382Fr,BigInteger384([16425459211378370116, 7893784342801357057, 5287367402839276261, 4375410306280908790, 15787361189636053546, 932309802470267583])),
        field_new!(BN382Fr,BigInteger384([4428187323229812783, 17059484676528313053, 2928936369154593582, 15091390798797864423, 564345908351553316, 41245242279677866])),
        field_new!(BN382Fr,BigInteger384([9319776400508100431, 16860785131583335694, 12115483334136948894, 14931135601074235552, 14220397525884796351, 600217763272957532])),
        field_new!(BN382Fr,BigInteger384([13597357950602372732, 414883829997741489, 13374762119118692110, 3830144749092354459, 13139838376002277646, 1195502231455530403])),
        field_new!(BN382Fr,BigInteger384([10185087874288831117, 11702143217510652607, 9728527493226334811, 13044555013277707716, 649528350459637172, 1159187145330002200])),
        field_new!(BN382Fr,BigInteger384([4491973945136073594, 14575341937632028952, 17444207911467240499, 11166349931870138554, 12067777935679475216, 1765209902824967019])),
        field_new!(BN382Fr,BigInteger384([6472671048752453284, 10455483107874155068, 11323647373984765473, 10781841414916355466, 14840012784486551718, 1721307699135872415])),
        field_new!(BN382Fr,BigInteger384([9469794434079240110, 4239319447373315706, 904735810510318877, 5867172430452276685, 12645954586963037836, 1703684940353148762])),
        field_new!(BN382Fr,BigInteger384([4778143789156317113, 11131815677251200494, 5204422930124871456, 15043214966520795319, 16318562769380761278, 1205483078184701622])),
        field_new!(BN382Fr,BigInteger384([8130377558001323816, 18065114152917765877, 7996268852608304675, 293764977396999638, 977637345108109103, 1689498644344889926])),
        field_new!(BN382Fr,BigInteger384([1264410372370190761, 18207781403462668281, 6532281133274077863, 8410247575194598265, 17834620119638800403, 1251027396827567854])),
        field_new!(BN382Fr,BigInteger384([14518841704291859009, 11633242415772144837, 5675321774419238342, 1271071456010216589, 2814595288231778966, 1046305144464172258])),
        field_new!(BN382Fr,BigInteger384([14573089082529138734, 16527518417829370098, 11925093582542124591, 2950374448837360165, 821798323461699532, 493357789086130969])),
        field_new!(BN382Fr,BigInteger384([17869808544299047860, 9720620140078504745, 14310404045687298905, 956859452583630467, 12308289604272836850, 161533454238478094])),
        field_new!(BN382Fr,BigInteger384([18031767375411324682, 13863254969430559682, 9980282021514396658, 7633748345330526804, 2321915167566621914, 2107257720934077472])),
        field_new!(BN382Fr,BigInteger384([7339687665360383914, 2234921940302700277, 2783798095395457154, 4834466351287477328, 15300007566437590174, 1171865370620059028])),
        field_new!(BN382Fr,BigInteger384([8465655014327527342, 15866549499002247292, 10273206347618166291, 8282869020217797047, 7137835207731120387, 898736871382151326])),
        field_new!(BN382Fr,BigInteger384([13386049961124997872, 8689735786426105663, 1535468230721358094, 3171739673767634179, 17093141204649025123, 2340368594031263341])),
        field_new!(BN382Fr,BigInteger384([10804784381981655685, 15817084604302890549, 10342883335185054771, 263991659210631669, 1227765243329577224, 2449204656805262984])),
        field_new!(BN382Fr,BigInteger384([17517607249309275539, 6816844552047558639, 3651301776786902531, 3314362914376532155, 14780789400122197366, 1567447552960354047])),
        field_new!(BN382Fr,BigInteger384([6328616370862214641, 4569549464979491311, 8989941603184399668, 15620650612352166971, 14427158210952193177, 237268773517976393])),
        field_new!(BN382Fr,BigInteger384([3473824478912011381, 3900574524614354741, 12549738343934008763, 15147198517315489142, 10346575965712578200, 1008682429921047792])),
        field_new!(BN382Fr,BigInteger384([13122757074080122925, 943369657558949356, 3036375404373905254, 6846696451821989006, 10745296258316479763, 1423070423281061132])),
        field_new!(BN382Fr,BigInteger384([9517070905095037664, 6941703003361184522, 8998972639562385673, 7610816990427502764, 15353859623785222227, 1144534772646009051])),
        field_new!(BN382Fr,BigInteger384([12218427048665313420, 12866764276294942096, 2475134102973453467, 528058292074489549, 18294343156522945204, 2378152779627211989])),
        field_new!(BN382Fr,BigInteger384([13780081895827144278, 11208725497860156147, 9215347199804958808, 3604371007568634708, 10268501773418692787, 79059179554236170])),
        field_new!(BN382Fr,BigInteger384([109577535206411143, 11361747763774165295, 11817545927358175944, 7455793047833348250, 9574224570050303299, 480340107785604502])),
        field_new!(BN382Fr,BigInteger384([3300513104479183969, 770715264327794288, 4641700730921407877, 10686150578672948698, 12734335866374153334, 831070006378207914])),
        field_new!(BN382Fr,BigInteger384([4729897107403000694, 12498231988899574334, 4209754023413794519, 17745082166923140214, 7054220295923103003, 1948710582794006459])),
        field_new!(BN382Fr,BigInteger384([9028322625269751934, 15537885682983633545, 1291974276378650805, 495081866201919354, 13134417253261610476, 2079572030012510089])),
        field_new!(BN382Fr,BigInteger384([2262197573771998959, 9595330136614596003, 3954820042994595515, 13289033750764339365, 12628940019752799017, 2037810911177171033])),
        field_new!(BN382Fr,BigInteger384([17455064705122026753, 7225268611196953363, 14199114753760895384, 220161175025506900, 5765694034101736819, 446260949867948368])),
        field_new!(BN382Fr,BigInteger384([9768478104411494973, 9080104986302782951, 6111548492618396085, 14709670441001177483, 10467935654151289369, 1320917518958714333])),
        field_new!(BN382Fr,BigInteger384([11772872562882808132, 13060561986494586652, 759305805456043634, 4804919008339364059, 4649941778564781285, 1556632141366134512])),
        field_new!(BN382Fr,BigInteger384([10794684585769682365, 11323445554345911202, 13054384188110527595, 1175808157574147286, 2544919485110711524, 2162873475018944281])),
        field_new!(BN382Fr,BigInteger384([3648180208690034736, 6197573513004935321, 328661126373844213, 683570431732174155, 18307166105296154702, 2197644134233617808])),
        field_new!(BN382Fr,BigInteger384([9921174455414613797, 11844724401927487365, 4987911481619511109, 8694946992911133838, 11587526127629758878, 993889445035922030])),
        field_new!(BN382Fr,BigInteger384([7335879872997473492, 17535633645790193731, 4711249094737881873, 3907375439243291893, 14321565084112820791, 648487926764088445])),
        field_new!(BN382Fr,BigInteger384([16479680044131790698, 9262433175805870177, 17871110840752563412, 6117274561459615283, 17690564821338498263, 1659450570689800984])),
        field_new!(BN382Fr,BigInteger384([13142220735602081629, 13805473929501399424, 8405334316308118857, 11249539483245933089, 15417373170254152684, 2078689287406471328])),
        field_new!(BN382Fr,BigInteger384([17206978890620437392, 7635872201285048427, 5484585943628848709, 4761355747376156534, 12152918582926108616, 2340552974658278483])),
        field_new!(BN382Fr,BigInteger384([8866115683710451693, 8862219867707994656, 11124676675783403164, 13655527570165084386, 2422500358991338637, 1375166885828223869])),
        field_new!(BN382Fr,BigInteger384([5799207174195027510, 14440364616882812999, 7759165410516352860, 3268457948691904777, 7913325746216803775, 1009712100931130870])),
        field_new!(BN382Fr,BigInteger384([6600259211217721934, 4746082052976391363, 2843740038489456313, 16118173196884898470, 5630240566864109261, 1919838003573528910])),
        field_new!(BN382Fr,BigInteger384([8583383849507343746, 15197443537036450506, 6879912162053836876, 1195678573696412580, 14792625143956814444, 2429849320257921559])),
        field_new!(BN382Fr,BigInteger384([4158725277889632773, 5677507358432142413, 13230092246199262478, 14351615112485899501, 10595704114823646743, 2474828496690049565])),
        field_new!(BN382Fr,BigInteger384([1928125939713413591, 6288507238449219737, 17662835038953785948, 5108622092984991229, 16308356214245896347, 1306011309067431097])),
        field_new!(BN382Fr,BigInteger384([12109577250018681997, 13498028250306079112, 17514084256780131754, 11592770169173137843, 6411849676138608316, 2202671170348188860])),
        field_new!(BN382Fr,BigInteger384([109309997016391529, 9305275287733161374, 5496288966688651586, 15369124999155138047, 15389560898750732073, 323878271639633090])),
        field_new!(BN382Fr,BigInteger384([948931521487051581, 12486516312004114892, 14411318966814105550, 75634264243864711, 14038352831647649608, 1247962469201453502])),
        field_new!(BN382Fr,BigInteger384([3772671777813633956, 14928727651201151643, 16362271929425948343, 16442090475102257011, 4072420611586345296, 874746665451288286])),
        field_new!(BN382Fr,BigInteger384([2994079160336363502, 16600053671870285415, 15165373442866903789, 11913873030265636366, 2340468789156238520, 1457848059138752907]))
    ];

    // The MDS matrix constants
    const MDS_CST: &'static [BN382Fr] = &[
        // Constants in Montgomery representation with R = 2^384
        field_new!(BN382Fr,BigInteger384([18446744073709551610, 18446744035050090351, 4581046414073821503, 14178100765618194937, 6349676926798234315, 60200215052524402])),
        field_new!(BN382Fr,BigInteger384([18446744073709551610, 18446744035050090351, 4581046414073821503, 14178100765618194937, 6349676926798234315, 2264014912943047591])),
        field_new!(BN382Fr,BigInteger384([18446744073709551611, 18446744041493333895, 6891996024013109855, 8740626625730237178, 14514769475853304404, 2165504505132229409])),
        field_new!(BN382Fr,BigInteger384([18446744073709551610, 18446744035050090351, 4581046414073821503, 14178100765618194937, 6349676926798234315, 2264014912943047591])),
        field_new!(BN382Fr,BigInteger384([18446744073709551610, 18446744035050090351, 4581046414073821503, 14178100765618194937, 6349676926798234315, 60200215052524402])),
        field_new!(BN382Fr,BigInteger384([18446744073709551615, 18446744067266308071, 16135794463770263263, 5437474139887957758, 10281651524654481527, 1328111356865177784])),
        field_new!(BN382Fr,BigInteger384([18446744073709551611, 18446744041493333895, 6891996024013109855, 8740626625730237178, 14514769475853304404, 2165504505132229409])),
        field_new!(BN382Fr,BigInteger384([18446744073709551615, 18446744067266308071, 16135794463770263263, 5437474139887957758, 10281651524654481527, 1328111356865177784])),
        field_new!(BN382Fr,BigInteger384([18446744073709551610, 18446744035050090351, 4581046414073821503, 14178100765618194937, 6349676926798234315, 60200215052524402]))
    ];
}

pub type BN382FrQuinticSbox = PoseidonQuinticSBox<BN382Fr, BN382FrPoseidonParameters>;
pub type BN382FrPoseidonHash = PoseidonHash<BN382Fr, BN382FrPoseidonParameters, BN382FrQuinticSbox>;
pub type BN382FrBatchPoseidonHash = PoseidonBatchHash<BN382Fr, BN382FrPoseidonParameters, BN382FrQuinticSbox>;
